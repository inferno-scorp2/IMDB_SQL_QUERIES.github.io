 <h2>SOLVING QUERIES ON IMDB DATASET USING SQL</h2>
 

Use imdb;
show tables;  

<br>&nbsp;</br>

select * from information_Schema.columns where table_schema='imdb';              -- this will give us an overview of whats in our dataset and tables.

<br>&nbsp;</br>

<b>1.Count the number of rows present in each table.</b>

<p>select
(select count(*) from directors) as directors_rows_count,
(select count(*) from directors_genres) as director_genres_rows_count,
(select count(*) from movies) as movies_rows_count,
(select count(*) from movies_directors) as movie_directors_rows_count,
(select count(*) from roles) as roles_rows_count;</p>

<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/1.png">

<br>&nbsp;</br>
<br>&nbsp;</br
<br>&nbsp;</br>
                                                                                                                        
<b>2.show the directors table.</b>
 
<p>select * from directors;</p>

<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/2.png">

<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>


<b>3.Are there any Null Values in movies table ?</b>    
                     
<p> -- 0 for 'No' and 1 for 'Yes' as we have used aggregate function sum().                              
 
<br>&nbsp;</br>
 
select sum(case  
when id is Null then 1 else 0 end ) as id, 
(case 
when name is Null then 1 else 0 end ) as name,
(case 
when year is Null then 1 else 0 end ) as year,
(case 
when rankscore is Null then 1 else 0 end ) as rankscore
from movies;</p>

<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/3.png">           
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>
                                                                      
<b>4.Show the movies released in each year.</b>

<p>select name as movie, year from movies group by year order by year;</p>
<br>&nbsp;</br>    

<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/4.png">

<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>5.Count the number of movies released each year.</b>

<p>select year,count(name) from movies group by year order by year;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/5.png">                                                                                 
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>
 
<b>6.Show the top 10 years with most movies released.</b>

<p>select year,count(name) as movies_count from movies group by year order by movies_count desc limit 10;</p>

<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/6.png">           

<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>7.What is the maximum, average, minimum rating(s) of all the movies</b>

<br>&nbsp;</br>
<p>select min(rankscore) from movies;                                                                             
 <br>&nbsp;</br>                              
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/7.1.png">
<br>&nbsp;</br>                                    
select avg(rankscore) from movies;                                          
<br>&nbsp;</br>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/7.2.png">
<br>&nbsp;</br>
select max(rankscore) from movies;</p>                                                                          
<br>&nbsp;</br>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/7.3.png">
                                                           
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>                                                 

<b>8.Show top ranked movies.</b>

<p>select movies.name, movies.rankscore from movies 
inner join (select name, max(rankscore) as maxrank from movies) movies2 on movies.rankscore=movies2.maxrank;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/8.png">
                                                                                                
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>
                                                                       
<b>9.Count the number of genres listed in the dataset and show what are those.</b>                          

<br>&nbsp;</br>

-- Genres             

<p>select distinct(genre) as count_of_genres from( 
select distinct(genre) from movies_genres
union
select distinct(genre) from directors_genres  ) as Genres ;
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/9.1.png">   
<br>&nbsp;</br>                                                                                  
-- Count of Genres                         
<br>&nbsp;</br>
select count(distinct(genre)) as count_of_genres from( 
select distinct(genre) from movies_genres
union
select distinct(genre) from directors_genres  ) as Genres ;</p>
                                  
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/9.2.png">   
                                                                             
<br>&nbsp;</br> 
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>10.Show the movies released by each director and store it in a temperory table.</b>
                                                                                                                    
<p>create temporary table table1 (select md.director_id, md.movie_id , dr.director_name ,mv.movie_name from movies_directors as md inner join
(select id as director_id,concat(first_name," ",last_name) as director_name from directors) dr on md.director_id=dr.director_id
inner join (select id as movie_id, name as movie_name from movies) mv on md.movie_id = mv.movie_id);
select * from table1;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/10.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>11.Show the top 20 directors who have directed most number of movies.</b>

<p>select director_name , count(movie_name) as movies_count from table1 group by director_name order by movies_count desc limit 20 ;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/11.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>12.Show the list of generes with most number of movies.</b>

<p>select genre, count(movie_id) as movies_count from movies_genres group by genre order by movies_count desc;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/12.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>13.Show the directors who have directed diverse genra of movies, order by genre most to least.</b>

<p>with directors_with_most_genres as(
select director_id, count(genre) as genre_count from directors_genres group by director_id order by genre_count desc) 
select  concat(directors.first_name,directors.last_name) as director_name, directors.id as directors_id, directors_with_most_genres.genre_count  from directors 
inner join directors_with_most_genres on directors.id=directors_with_most_genres.director_id;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/13.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>14.Order movies from most to least number of roles played in the movies;</b>

<p>with rolescount as 
(select movie_id,count(role) as number_of_roles from roles group by movie_id )
select  movies.name, rolescount.number_of_roles from movies inner join rolescount on movies.id=rolescount.movie_id order by number_of_roles desc;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/14.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>
 
<b>15.Show the movies whose name start with 'An' and having rankscore>9.</b>

<p>select * from movies where name like 'An%' having rankscore>9;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/15.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>16.Show the movies having name start with 'Fig' end with 'ub' , having charecter length 10 and released in 1999.</b>

<p>select * from movies where name like 'Fig%ub'and length(name)=10 and year=1999; 
 <br>&nbsp;</br>
-- Note: Space(" ") is  also is a charecter.</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/16.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>17.Show the movies from 1800 to 2000 having rankscore greater than 9.5;</b>

<p>select * from movies having year between 1800 and 2000 and rankscore>9.5 order by year;</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/17.png">

<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>

<b>18.Show the rankscores of the movies table having names ('Top Gun','Blade Runner','Border') and years they were released in.</b>
<br>&nbsp;</br>

<p>select lower(name),rankscore,year from movies where name in ('top gun','blade runner','border');</p>
<img src="https://raw.githubusercontent.com/inferno-scorp2/IMDB_SQL_QUERIES.github.io/main/sql/18.png">
<br>&nbsp;</br>
<br>&nbsp;</br>
<br>&nbsp;</br>
